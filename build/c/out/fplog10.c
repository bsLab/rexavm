#include "config.h"
#include "standard.h"
#include "vm.h"
#include "vmio.h"
#include "fplog10.h"

static ub1 log10lut[] = {
0, // x=10
4, // x=11
7, // x=12
11, // x=13
14, // x=14
17, // x=15
20, // x=16
23, // x=17
25, // x=18
27, // x=19
30, // x=20
32, // x=21
34, // x=22
36, // x=23
38, // x=24
39, // x=25
41, // x=26
43, // x=27
44, // x=28
46, // x=29
47, // x=30
49, // x=31
50, // x=32
51, // x=33
53, // x=34
54, // x=35
55, // x=36
56, // x=37
57, // x=38
59, // x=39
60, // x=40
61, // x=41
62, // x=42
63, // x=43
64, // x=44
65, // x=45
66, // x=46
67, // x=47
68, // x=48
69, // x=49
69, // x=50
70, // x=51
71, // x=52
72, // x=53
73, // x=54
74, // x=55
74, // x=56
75, // x=57
76, // x=58
77, // x=59
77, // x=60
78, // x=61
79, // x=62
79, // x=63
80, // x=64
81, // x=65
81, // x=66
82, // x=67
83, // x=68
83, // x=69
84, // x=70
85, // x=71
85, // x=72
86, // x=73
86, // x=74
87, // x=75
88, // x=76
88, // x=77
89, // x=78
89, // x=79
90, // x=80
90, // x=81
91, // x=82
91, // x=83
92, // x=84
92, // x=85
93, // x=86
93, // x=87
94, // x=88
94, // x=89
95, // x=90
95, // x=91
96, // x=92
96, // x=93
97, // x=94
97, // x=95
98, // x=96
98, // x=97
99, // x=98
99, // x=99
};

// x-scale is 1:10 and log10-scale is 1:100
sb2 fplog10(sb2 x) {
  sb2 shift=0;
  while (x>=100) { shift++; x/=10; };
  return shift*100+(sb2)log10lut[x-10];
}

